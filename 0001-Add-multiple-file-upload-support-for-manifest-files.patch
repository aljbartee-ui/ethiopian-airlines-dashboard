From 0c49f4b05302dfca8567a2c5a99bb0c93b7c1114 Mon Sep 17 00:00:00 2001
From: aljbartee-ui <238954065+aljbartee-ui@users.noreply.github.com>
Date: Mon, 2 Feb 2026 04:33:36 -0500
Subject: [PATCH] Add multiple file upload support for manifest files

---
 src/static/load-factor.html | 82 +++++++++++++++++++++++++++----------
 1 file changed, 61 insertions(+), 21 deletions(-)

diff --git a/src/static/load-factor.html b/src/static/load-factor.html
index aa616c2..0f99a5e 100644
--- a/src/static/load-factor.html
+++ b/src/static/load-factor.html
@@ -240,6 +240,20 @@
             color: var(--et-red-light);
         }
 
+        .upload-status.warning {
+            display: block;
+            background: rgba(255, 204, 0, 0.2);
+            border: 1px solid var(--et-yellow);
+            color: var(--et-yellow-light);
+        }
+
+        .upload-status small {
+            display: block;
+            margin-top: 5px;
+            opacity: 0.8;
+            font-size: 0.75rem;
+        }
+
         /* Filters */
         .filters-section {
             background: rgba(255, 255, 255, 0.05);
@@ -585,9 +599,9 @@
                     <div class="upload-zone" onclick="document.getElementById('manifestInput').click()">
                         <i class="fas fa-file-alt"></i>
                         <h4>Manifest File</h4>
-                        <p>Upload manifest file (.txt, .csv)</p>
+                        <p>Upload manifest files (.txt, .csv) - Multiple files supported</p>
                     </div>
-                    <input type="file" id="manifestInput" accept=".txt,.csv" style="display: none;" onchange="handleManifestUpload(event)">
+                    <input type="file" id="manifestInput" accept=".txt,.csv" multiple style="display: none;" onchange="handleManifestUpload(event)">
                     <div class="upload-status" id="manifestStatus"></div>
                 </div>
             </div>
@@ -776,36 +790,62 @@
         }
 
         async function handleManifestUpload(event) {
-            const file = event.target.files[0];
-            if (!file) return;
+            const files = event.target.files;
+            if (!files || files.length === 0) return;
             
             const statusEl = document.getElementById('manifestStatus');
             statusEl.className = 'upload-status';
-            statusEl.textContent = 'Uploading...';
+            statusEl.textContent = `Uploading ${files.length} file(s)...`;
             statusEl.style.display = 'block';
             
-            const formData = new FormData();
-            formData.append('file', file);
+            let successCount = 0;
+            let errorCount = 0;
+            let errors = [];
             
-            try {
-                const response = await fetch('/api/manifest/upload', {
-                    method: 'POST',
-                    body: formData
-                });
+            // Upload files one by one
+            for (let i = 0; i < files.length; i++) {
+                const file = files[i];
+                statusEl.textContent = `Uploading ${i + 1}/${files.length}: ${file.name}...`;
                 
-                const data = await response.json();
+                const formData = new FormData();
+                formData.append('file', file);
                 
-                if (response.ok) {
-                    statusEl.className = 'upload-status success';
-                    statusEl.innerHTML = `<i class="fas fa-check-circle"></i> ${data.message}`;
-                    loadData();
-                } else {
-                    throw new Error(data.error);
+                try {
+                    const response = await fetch('/api/manifest/upload', {
+                        method: 'POST',
+                        body: formData
+                    });
+                    
+                    const data = await response.json();
+                    
+                    if (response.ok) {
+                        successCount++;
+                    } else {
+                        errorCount++;
+                        errors.push(`${file.name}: ${data.error}`);
+                    }
+                } catch (error) {
+                    errorCount++;
+                    errors.push(`${file.name}: ${error.message}`);
                 }
-            } catch (error) {
+            }
+            
+            // Show final status
+            if (errorCount === 0) {
+                statusEl.className = 'upload-status success';
+                statusEl.innerHTML = `<i class="fas fa-check-circle"></i> Successfully uploaded ${successCount} file(s)`;
+                loadData();
+            } else if (successCount === 0) {
                 statusEl.className = 'upload-status error';
-                statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${error.message}`;
+                statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> Failed to upload all files<br><small>${errors.join('<br>')}</small>`;
+            } else {
+                statusEl.className = 'upload-status warning';
+                statusEl.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Uploaded ${successCount} file(s), ${errorCount} failed<br><small>${errors.join('<br>')}</small>`;
+                loadData();
             }
+            
+            // Reset file input
+            event.target.value = '';
         }
 
         function applyFilters() {
-- 
2.34.1

